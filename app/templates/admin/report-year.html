{% extends 'admin/master.html' %}

{% block body %}
    <script src="{{ url_for('static', filename='Chart.min.js') }}">
    </script>

    <h2 class="text-center">Báo cáo năm</h2>

    <form class="form-group" action="{{ url_for('reportyear.report_year') }}" method="post">
        <input class="form-control" type="text" placeholder="Nhập năm cần hiển thị báo cáo" name="year_name">
        <br>
        <button class="btn btn-primary">Hiển thị</button>
    </form>

    {% if year_name %}
        <h2>Thông tin báo cáo tháng: {{ year_name }}</h2>
    {% endif %}

    </br>
    <table class="table table-bordered table-hover">
            <tr>
                <th class="text-center">Tháng</th>
                <th class="text-center">Số chuyến bay</th>
                <th class="text-center">Doanh thu</th>
            </tr>
            {% if report_year %}
                    {% for r in report_year %}
                    <tr>
                        <td class="text-center">{{ r.thang }}</td>
                        <td class="text-center">{{ r.SoChuyenBay }}</td>
                        <td class="text-center">{{ r.DoanhThu }}</td>
                    </tr>
                    {% endfor %}
                {% endif %}
        </table>

    <div><br></div>

    <h2 class="text-center">Biếu đồ doanh thu</h2>
    <br>
    <!-- bar chart canvas element -->
    <canvas class="center-block" id="myChart" width="1100" height="800"></canvas>

    <br>
    <br>
    <br>
    <br>

<script>
// Global parameters:
// do not resize the chart canvas when its container does (keep at 600x400px)
Chart.defaults.global.responsive = false;

// define the chart data
var chartData = {
  // labels : ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
  labels : [{% for item in report_year %}
                {{item.thang}},
             {% endfor %}
            ],
  datasets : [{
      label: 'Biểu đồ doanh thu theo năm',
      fill: true,
      lineTension: 0.1,
      backgroundColor: "rgba(75,192,192,0.4)",
      borderColor: "rgba(75,192,192,1)",
      borderCapStyle: 'butt',
      borderDash: [],
      borderDashOffset: 0.0,
      borderJoinStyle: 'miter',
      pointBorderColor: "rgba(75,192,192,1)",
      pointBackgroundColor: "#fff",
      pointBorderWidth: 1,
      pointHoverRadius: 5,
      pointHoverBackgroundColor: "rgba(75,192,192,1)",
      pointHoverBorderColor: "rgba(220,220,220,1)",
      pointHoverBorderWidth: 2,
      pointRadius: 1,
      pointHitRadius: 10,
      // data: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1000000"],
      data : [{% for item in report_year %}
                {{item.DoanhThu}},
              {% endfor %}],
      spanGaps: false
  }]
}

// get chart canvas
var ctx = document.getElementById("myChart").getContext("2d");

// create the chart using the chart canvas
var myChart = new Chart(ctx, {
  type: 'line',
  data: chartData,
});

</script>

{% endblock %}
